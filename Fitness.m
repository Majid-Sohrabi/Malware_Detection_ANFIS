function [z, out]=Fitness(x,fis,Data)
    MinAbs=1e-5;
    if any(abs(x)<MinAbs)
        S=(abs(x)<MinAbs);
        x(S)=MinAbs.*sign(x(S));
    end    
    p0=Fis_GetParameters(fis);       
    p=x.*p0;            
    fis=Fis_SetParameters(fis,p);            
    x=Data.TrainInputs;    
    t=Data.TrainTargets;        
    y=evalfis(x,fis);        
    e=t-y;        
    MSE=mean(e(:).^2);    
    RMSE=sqrt(MSE);                  
    %out.fis=fis;    
    %out.y=y;
    %out.e=e;
    %out.MSE=MSE;
    
    RR=sum((abs(y-mean(y))).*(abs(t-mean(t))));
    RR=(RR^2)/(sum(abs(y-mean(y)))*sum(abs(t-mean(t))));
    out.RMSE=RMSE;    
    out.RR=RR;
%   z=RR+RMSE;
    z=RMSE;
end